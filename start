SCRIPT_DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"

function startDockerMachine {
  if [[ $(docker-machine ls dev -q) -ne "dev" ]]; then
    docker-machine create -d virtualbox dev --virtualbox-disk-size "30000" --virtual-hostonly-cidr "192.168.99.1/24" -virtualbox-memory "2048" || true
  fi
  eval "$(docker-machine env dev)"

  if [[ -z $(docker-compose ps -q) ]]; then
    docker-compose up -d
  else
    docker-compose start
  fi
}

function setupHostAliases {
  DEV_IP=$(docker-machine ip dev)
  echo "$DEV_IP gitter-dev.local" > "$SCRIPT_DIR/hostaliases"
  export HOSTALIASES="$SCRIPT_DIR/hostaliases"
}

startDockerMachine
setupHostAliases
