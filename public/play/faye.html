<html>
<head>
<script type="text/javascript"
        src="/js/libs/faye/0.8.8/faye-browser-min.js">
        </script>
<script type="text/javascript">


var ClientAuth = function() {};

ClientAuth.prototype.outgoing = function(message, callback) {
  message.ext = message.ext || {};
  message.ext.token = "99f782a6-fd45-49a6-82a8-2801c2832296";
  callback(message);
};


var client = new Faye.Client('http://localhost:5000/faye');
client.addExtension(new ClientAuth());

client.bind('transport:down', function() {
  // the client is offline
  if (typeof console != "undefined") console.log("TRANSPORT DOWN");
});

client.bind('transport:up', function() {
  // the client is online
  if (typeof console != "undefined") console.log("TRANSPORT UP");
});

client.publish('/foo', {text: 'Hi there'});

var subscription = client.subscribe('/troupes/4fda5526219fc80000001d21', function(message) {
  if (typeof console != "undefined") console.log("MESSAGE!", message);
});

</script>
</head>

<body>

</body>
</html>