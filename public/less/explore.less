@import 'colors';
@import 'buttons';
@import 'pills';
@import 'typography';

@bg-color: #ffffff;
// if you change this, make sure to change the image url "s" param.
// it has to be double to support retina displays.
@AVATAR_SIZE: 4 * 0.625em; // @const


html {
  box-sizing: border-box;
}

body {
  background-color: @bg-color;
  margin: 0;
}

*, *:before, *:after {
  box-sizing: inherit;
}







.tag-pill-list(@num-rows: 2, @num-per-row: 5) {
  @tag-vertical-padding: 0.75em;
  @tag-margin: 1rem;

  @tag-width: calc((100% / @num-per-row) ~"-" ((@tag-margin * (@num-per-row - 1)) / @num-per-row));
  @tag-height: (1em + (2 * @tag-vertical-padding));
  @tag-margin-box: @tag-height + @tag-margin;

  .tag-pill-list {
    overflow: hidden;
    position: relative;
    display: flex;
    flex-wrap: wrap;
    justify-content: flex-start;
    align-items: stretch;

    // 2 rows + margin - the margin we don't have on the first row
    height: calc(@num-rows * @tag-margin-box - @tag-margin);

    margin: 0;
    padding: 0;
    list-style: none;
  }


  .tag-pill-list-item {
    display: inline-block;
    width: @tag-width;
    margin-right: @tag-margin;

    // Only put top margin on the second row onward
    @num-per-row-plus: @num-per-row + 1;
    &:nth-child(n + @{num-per-row-plus}) {
      margin-top: @tag-margin;
    }
    &:nth-child(@{num-per-row}n) {
      margin-right: 0;
    }

    /* * /
    // Hide the extra tags
    @extra-tag-start-index: @num-rows * @num-per-row;
    &:nth-child(n + @{extra-tag-start-index}) {
      visibility: hidden;
    }
    /* */
  }


  .tag-pill {
    overflow: hidden;
    display: flex;
    justify-content: center;
    align-items: center;
    padding: @tag-vertical-padding 2em;

    background-color: @pampas;
    border-radius: 4px;

    color: #808080;
    line-height: 1;
    white-space: nowrap;
    text-overflow: ellipsis;

    cursor: pointer;

    transition:
      background-color 0.2s ease,
      color 0.2s ease;

    .tag-pill-checkbox-toggle:checked + & {
      background-color: @jaffa;
      color: #ffffff;
    }
  }

  .tag-pill-checkbox-toggle {
    display: none;
  }



  .tag-pill-list-pagination-item {
    position: absolute;
    bottom: 0;
    right: 0;

    display: flex;
    width: @tag-width;
    height: @tag-height;

    background-color: @bg-color;
    border: 1px solid @pampas;
    border-radius: 4px;

    & > * {
      flex: 1;
      display: block;
    }
  }
}


@media-tag-list-large: 1300px;
@media-tag-list-medium: 1100px;
@media-tag-list-small: 700px;


// `postcss-reverse-media` would be nice here: https://github.com/MadLittleMods/postcss-reverse-media
@media (min-width: (@media-tag-list-large + 0.001)) {
  .tag-pill-list(2, 8);
}

@media (max-width: @media-tag-list-large) and (min-width: (@media-tag-list-medium + 0.001)) {
  .tag-pill-list(2, 6);
}

@media (max-width: @media-tag-list-medium) and (min-width: (@media-tag-list-small + 0.001)) {
  .tag-pill-list(2, 4);
}

@media (max-width: @media-tag-list-small) {
  .tag-pill-list(2, 3);
}





.explore-room-item {

  @color: white;
  opacity: 0.7;
  flex: 1 0 15.625em;
  margin: 0.8em;
  max-height: 10em;
  color: #333;
  display: flex;
  flex-direction: column;

  &:hover {
    opacity: 1;
  }

  header {
    // border-top: 0.4em solid @personal;
    border-radius: 3px 3px 0 0;
    background-color: @color;
    padding: 0.625em;
    height: @AVATAR_SIZE + 2 * 0.625em;
    line-height: @AVATAR_SIZE;
    overflow: hidden;
  }

  // &:nth-child(3n + 3) header {
  //   border-top: 0.4em solid @silver;
  // }

  // &:nth-child(2n + 1) header {
  //   border-top: 0.4em solid @bronze;
  // }

  &__avatar {
    float: left;
    width: @AVATAR_SIZE;
    margin-right: 0.625em;
    border-radius: 3px;
  }

  &__description {
    background-color: @color;
    padding: 0 0.625em 0.625em;
    max-height: 3.4375em;
    overflow: hidden;
    position: relative;

    &:after {
      content: "";
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 2 * 0.625em;
      background: linear-gradient(to bottom,  rgba( red(@color), green(@color), blue(@color), 0) 0%, rgba( red(@color), green(@color), blue(@color), 1) 100%); /* W3C */
    }
  }

  &__content {
    background-color: @color;
    flex-grow: 1;
    padding: 0.625em;
  }

  footer {
    background-color: @color;
    color: #444;
    border-radius: 0 0 3px 3px;
    padding: 0.625em;
    flex-shrink: 0;
    border-top: 1px dotted hsl(0, 0%, 90%);
    text-transform: uppercase;
    display: flex;
    flex-direction: row;

    small {
      text-align: center;
      flex-grow: 1;

      &:first-child {
        text-align: left;
      }

      &:last-child {
        text-align: right;
      }
    }
  }
}

.repo-name {
  display: flex;
}

.repo-name__collapsable {
  display: inline-block;
  text-overflow: ellipsis;
  white-space: nowrap;
  overflow: hidden;
  flex-shrink: 1000;
  transition: flex-shrink 300ms ease-in-out;
}

.repo-name span:not(.repo-name__collapsable) {
  flex-shrink: 0;
}

.repo-name__collapsable:last-child,
.repo-name__collapsable:hover {
  flex-shrink: 0.01;
}

.repo-name__collapsable:last-child ~ .repo-name__collapsable,
.repo-name span:hover ~ .repo-name__collapsable {
  flex-shrink: 1000;
}
