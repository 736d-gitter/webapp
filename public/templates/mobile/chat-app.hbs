  <!doctype html>
  <html class="no-js" lang="en" {{#useAppCache}}manifest="/mobile.appcache"{{/useAppCache}}>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, user-scalable=no"/>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta charset="utf-8">

    <title>{{troupeName}}</title>

    <link rel="stylesheet" href='/bootstrap/css/trpMobileChat.css'>

    <script type="text/javascript">
    window.troupeContext = {{{troupeContext}}};
    {{#if data}}
    window.troupePreloads = {{{data}}};
    {{/if}}

    </script>


    {{>require_wrapper}}

    {{{bootScript "router-mobile-chat" skipCdn=true }}}

    <link rel="shortcut icon" href="images/favicon.ico">

</head>
<body>

  <div class="trpMobileAmuse fade-in" id="chat-amuse">
    <div class="trpMobileAmuseIcon">
      <img src='{{cdn "images/2/troupe-ajax-guy-green.gif" }}'><br><br>Loading
    </div>
  </div>

  <div id="troupeListPanel" style="width: 200px; position: absolute; margin-left: -200px; top: 0;" class="sideMenu">
    <ul id="troupeList" class="trpTroupeList"></ul>
  </div>
  <div id="pageContainer" style="height: 100%; overflow-x: hidden;">
<div id="mainPage" style="height: 100%;">
  {{#if isWebApp}}
  <header id="nav-bar">
    <a href="#"style="
    position: absolute;
    left: 0;
    top: 0;
    padding: 7px 5px;
" onclick="window.list();"><img src='{{cdn "images/2/menu-toggle.png" }}' width="40" height="40" id="menu-toggle"></a>
    <span class="title">{{troupeName}}</span>
  </header>
  {{/if}}

  <div class="contentBody mobile-scroll-class" id="chat-wrapper" style="height: 1000px;">
    <div class="frame-chat">
     <div class="trpChatPanel" id="chat-frame">
        <div class="chatPanel" id="frame-chat">
        </div>
      </div>
    </div>
  </div>

  <div class="trpChatInputArea" id="chat-input" style="display:none;">
  </div>
  </div>
</div>
  <script type="text/javascript">
  var isTroupeListShowing = false;
  var menuWidth = 200;
  window.list = function() {
  var pageContainer = document.getElementById('pageContainer');
  var troupeList = document.getElementById('troupeListPanel');
    if(!isTroupeListShowing) {
      $.get('/troupes', function(data) {
        var $list = $('#troupeList');
        $list.empty();
        data.forEach(function (troupe) {
          $list.append('<li><a href="'+troupe.url+'">'+troupe.name+'</a></li>');
        });
      }, 'json');
      document.getElementById('mainPage').style.width = window.innerWidth+"px";
      pageContainer.style.marginLeft = menuWidth + "px";
      pageContainer.style.width = (window.innerWidth - menuWidth) + "px";
      troupeList.style.marginLeft = "0px";
      isTroupeListShowing = true;
    } else {
      pageContainer.style.marginLeft = "0px";
      pageContainer.style.width = "100%";
      troupeList.style.marginLeft = "-200px";
      isTroupeListShowing = false;
    }

  }
  </script>
</body>
</html>
